hdfs:
  # image: gallna/hadoop:2.7.3
  build: .
  dockerfile: "Dockerfile.hadoop"
  volumes:
    - ./bin/entrypoint.sh:/usr/local/bin/entrypoint.sh
    - ./etc/hadoop/yarn-env.sh:/usr/local/hadoop/etc/hadoop/yarn-env.sh
    - ./etc/hadoop/hadoop-env.sh:/usr/local/hadoop/etc/hadoop/hadoop-env.sh
    - ./etc/hadoop/log4j.properties:/usr/local/hadoop/etc/hadoop/log4j.properties
    - ./etc/hadoop/core-site.xml:/usr/local/hadoop/etc/hadoop/core-site.xml
    - ./etc/hadoop/hdfs-site.xml:/usr/local/hadoop/etc/hadoop/hdfs-site.xml
    - ./etc/hadoop/yarn-site.xml:/usr/local/hadoop/etc/hadoop/yarn-site.xml
    - ./etc/hadoop/mapred-site.xml:/usr/local/hadoop/etc/hadoop/mapred-site.xml

namenode:
  extends: hdfs
  entrypoint: entrypoint.sh -N
  container_name: namenode
  hostname: namenode
  expose:
    - 8020
  ports:
    - 50070

datanode:
  extends: hdfs
  entrypoint: entrypoint.sh --datanode
  container_name: datanode
  hostname: datanode
  expose:
    - 50010
    - 50020
  ports:
    - 50075

resource-manager:
  extends: hdfs
  entrypoint: entrypoint.sh --resource-manager
  container_name: resource-manager
  hostname: resource-manager
  expose:
    - 8031
    - 8032
    - 8033
  ports:
    - 8088

job-history:
  extends: hdfs
  entrypoint: entrypoint.sh --job-history
  container_name: job-history
  hostname: job-history
  expose:
    - 10020
    - 50030
    - 50060
    - 10033
  ports:
    - 19888
